# ACE-Code Default Configuration
# ================================

# Model Configuration
model:
  name: "gemma-2-2b"  # Model name or HuggingFace path
  device: "cuda"       # Device to run on (cuda, cpu, auto)
  dtype: "float16"     # Model dtype (float32, float16, bfloat16)
  use_transformer_lens: true  # Use TransformerLens for hooks
  load_in_8bit: false  # Use 8-bit quantization
  load_in_4bit: false  # Use 4-bit quantization
  cache_dir: null      # Cache directory for downloaded models

# Circuit Discovery (CD-T) Configuration
circuit_discovery:
  target_layers: [10, 11, 12, 13, 14]  # Layers to analyze
  use_attention_shortcut: true         # Use simplified attention decomposition
  decompose_mlp: true                  # Include MLP in decomposition
  decompose_layernorm: true            # Handle LayerNorm decomposition

# PAHQ Configuration (Memory Optimization)
pahq:
  enabled: false                  # Enable PAHQ quantization
  target_precision: "float32"     # Precision for target component
  background_precision: "float16" # Precision for other components
  quantize_mlp_int8: false       # Use INT8 for MLPs

# SAE Configuration
sae:
  layer: 12            # Layer to attach SAE
  path: null           # Path to pre-trained SAE checkpoint
  sae_id: null         # SAE Lens / Neuronpedia ID
  n_features: null     # Number of features (auto if null)
  t_threshold: 2.0     # T-statistic threshold for feature selection
  top_k_features: 20   # Max features to identify

# Mutation Testing Configuration
mutation:
  types:
    - type_hint_removal
    - variable_rename
    - operator_swap
    - off_by_one
    - argument_swap
  n_pairs_per_snippet: 2  # Pairs to generate per code snippet
  seed: 42               # Random seed for reproducibility

# Steering Configuration
steering:
  default_strength: 1.0  # Default alpha value
  normalize: true        # Normalize steering vectors
  positions: [-1]        # Token positions to steer (-1 = last)

# PISCES Configuration
pisces:
  component: "mlp_out"   # Default component to edit
  strength: 1.0          # Default removal strength
  normalize_direction: true
  backup: true           # Backup weights before editing

# Output Configuration
output:
  dir: "./ace_output"
  save_intermediate: true
  log_level: "INFO"
